<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_21) on Mon Sep 20 22:29:36 CEST 2010 -->
<TITLE>
Host_signature
</TITLE>

<META NAME="date" CONTENT="2010-09-20">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Host_signature";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Host_signature.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../ds/ov2/front/Hash_size.html" title="class in ds.ov2.front"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../ds/ov2/front/Host_testframe.html" title="class in ds.ov2.front"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?ds/ov2/front/Host_signature.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Host_signature.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
ds.ov2.front</FONT>
<BR>
Class Host_signature</H2>
<PRE>
<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">ds.ov2.util.Serializable_array</A>
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>ds.ov2.front.Host_signature</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>Host_signature</B><DT>extends <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A><DT>implements <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></DL>
</PRE>

<P>
Host data type for <A HREF="../../../ds/ov2/front/Signature.html" title="class in ds.ov2.front"><CODE>Signature's</CODE></A> with signature
 checking. Used to receive objects of type <A HREF="../../../ds/ov2/front/Signature.html" title="class in ds.ov2.front"><CODE>Signature</CODE></A> from
 the card. This class further implements the validity check for
 signatures. This class does not implement sending a signature to
 the card, because signatures are established on the card in a
 completely differnt way.
 <P>

 For a general description of signatures, the validity check and the
 hash-size issue, see <A HREF="../../../ds/ov2/front/Signature.html" title="class in ds.ov2.front"><CODE>Signature</CODE></A>.
 <P>

 This is a host data type. It is compatible with nothing. The card
 data type <A HREF="../../../ds/ov2/front/Signature.html" title="class in ds.ov2.front"><CODE>Signature</CODE></A> is compatible with this class.
<P>

<P>
<DL>
<DT><B>CPP Preprocessing</B></DT>
  <DD>no cpp preprocessing needed</DD>
<DT><B>Execution Environment:</B></DT>
  <DD>host</DD>
<DT><B>Author:</B></DT>
  <DD>Hendrik Tews</DD>
<DT><B>Version:</B></DT>
  <DD>$Revision: 1.19 $</DD>
<DT><B>Last Commit:</B></DT>
  <DD>$Date: 2009-06-19 20:37:36 $ by $Author: tews $</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../ds/ov2/util/APDU_byte_array.html" title="class in ds.ov2.util">APDU_byte_array</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#apdu_hash">apdu_hash</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APDU container for the hash.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../ds/ov2/bignat/APDU_BigInteger.html" title="class in ds.ov2.bignat">APDU_BigInteger</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#apdu_number">apdu_number</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APDU container for the number.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="http://java.sun.com/javase/6/docs/api/java/security/MessageDigest.html?is-external=true" title="class or interface in java.security">MessageDigest</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#digest">digest</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHA-1 hash instance.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#hash">hash</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The hash part of the signature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;<A HREF="http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#number">number</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number part of the signature.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html?is-external=true" title="class or interface in java.io">PrintWriter</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#out">out</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug channel.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#serializable_contents">serializable_contents</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array of the two APDU containers in support for <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#Host_signature(short, short, byte)">Host_signature</A></B>(short&nbsp;short_bignat_size,
               short&nbsp;long_bignat_size,
               byte&nbsp;applet_id)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a new host signature object.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#check_signature_ex(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)">check_signature_ex</A></B>(<A HREF="http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;blinded_a,
                   <A HREF="../../../ds/ov2/front/PTLS_rsa_parameters.html" title="class in ds.ov2.front">PTLS_rsa_parameters</A>&nbsp;params,
                   boolean&nbsp;montgomerized)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug and exception wrapper for <A HREF="../../../ds/ov2/front/Host_signature.html#check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)"><CODE>check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)">check_signature</A></B>(<A HREF="http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;blinded_a,
                <A HREF="../../../ds/ov2/front/PTLS_rsa_parameters.html" title="class in ds.ov2.front">PTLS_rsa_parameters</A>&nbsp;params,
                boolean&nbsp;montgomerized)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signature check.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#from_byte_array(short, short, byte[], short)">from_byte_array</A></B>(short&nbsp;len,
                short&nbsp;this_index,
                byte[]&nbsp;byte_array,
                short&nbsp;byte_index)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deserialization of this object for the OV-chip protocol layer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#get_array()">get_array</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return <A HREF="../../../ds/ov2/front/Host_signature.html#serializable_contents"><CODE>serializable_contents</CODE></A> in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#get_hash_size()">get_hash_size</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the size of the hash <A HREF="../../../ds/ov2/front/Host_signature.html#hash"><CODE>hash</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#get_length()">get_length</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return 2 as effective size in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Host_signature.html#get_number_size()">get_number_size</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the size of the number <A HREF="../../../ds/ov2/front/Host_signature.html#number"><CODE>number</CODE></A>.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_ds.ov2.util.Serializable_array"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class ds.ov2.util.<A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#is_compatible_with(java.lang.Object)">is_compatible_with</A>, <A HREF="../../../ds/ov2/util/Serializable_array.html#size()">size</A>, <A HREF="../../../ds/ov2/util/Serializable_array.html#to_byte_array(short, short, byte[], short)">to_byte_array</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_ds.ov2.util.APDU_Serializable"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface ds.ov2.util.<A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../ds/ov2/util/APDU_Serializable.html#is_compatible_with(java.lang.Object)">is_compatible_with</A>, <A HREF="../../../ds/ov2/util/APDU_Serializable.html#size()">size</A>, <A HREF="../../../ds/ov2/util/APDU_Serializable.html#to_byte_array(short, short, byte[], short)">to_byte_array</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="hash"><!-- --></A><H3>
hash</H3>
<PRE>
byte[] <B>hash</B></PRE>
<DL>
<DD>The hash part of the signature. Initialized in <A HREF="../../../ds/ov2/front/Host_signature.html#from_byte_array(short, short, byte[], short)"><CODE>from_byte_array</CODE></A>.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="number"><!-- --></A><H3>
number</H3>
<PRE>
<A HREF="http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A> <B>number</B></PRE>
<DL>
<DD>The number part of the signature. Initialized in <A HREF="../../../ds/ov2/front/Host_signature.html#from_byte_array(short, short, byte[], short)"><CODE>from_byte_array</CODE></A>.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="apdu_hash"><!-- --></A><H3>
apdu_hash</H3>
<PRE>
private <A HREF="../../../ds/ov2/util/APDU_byte_array.html" title="class in ds.ov2.util">APDU_byte_array</A> <B>apdu_hash</B></PRE>
<DL>
<DD>APDU container for the hash.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="apdu_number"><!-- --></A><H3>
apdu_number</H3>
<PRE>
private <A HREF="../../../ds/ov2/bignat/APDU_BigInteger.html" title="class in ds.ov2.bignat">APDU_BigInteger</A> <B>apdu_number</B></PRE>
<DL>
<DD>APDU container for the number.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="serializable_contents"><!-- --></A><H3>
serializable_contents</H3>
<PRE>
private <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[] <B>serializable_contents</B></PRE>
<DL>
<DD>Array of the two APDU containers in support for <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="digest"><!-- --></A><H3>
digest</H3>
<PRE>
private <A HREF="http://java.sun.com/javase/6/docs/api/java/security/MessageDigest.html?is-external=true" title="class or interface in java.security">MessageDigest</A> <B>digest</B></PRE>
<DL>
<DD>SHA-1 hash instance.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="out"><!-- --></A><H3>
out</H3>
<PRE>
public static <A HREF="http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html?is-external=true" title="class or interface in java.io">PrintWriter</A> <B>out</B></PRE>
<DL>
<DD>Debug channel. If non-null print debug information to this
 channel. Must be set from the outside.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Host_signature(short, short, byte)"><!-- --></A><H3>
Host_signature</H3>
<PRE>
public <B>Host_signature</B>(short&nbsp;short_bignat_size,
                      short&nbsp;long_bignat_size,
                      byte&nbsp;applet_id)</PRE>
<DL>
<DD>Create a new host signature object. Internal numbers and
 buffers depend on the exponent and base sizes as well as on the
 applet that we communicate with (see <A HREF="../../../ds/ov2/front/Hash_size.html" title="class in ds.ov2.front"><CODE>Hash_size</CODE></A>).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>short_bignat_size</CODE> - size of the exponent bignats in bytes<DD><CODE>long_bignat_size</CODE> - size of the base bignats in bytes<DD><CODE>applet_id</CODE> - the applet ID
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/javase/6/docs/api/java/lang/RuntimeException.html?is-external=true" title="class or interface in java.lang">RuntimeException</A></CODE> - with a cause of type
 NoSuchAlgorithmException if the SHA-1 hash function cannot be
 found.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)"><!-- --></A><H3>
check_signature</H3>
<PRE>
private boolean <B>check_signature</B>(<A HREF="http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;blinded_a,
                                <A HREF="../../../ds/ov2/front/PTLS_rsa_parameters.html" title="class in ds.ov2.front">PTLS_rsa_parameters</A>&nbsp;params,
                                boolean&nbsp;montgomerized)</PRE>
<DL>
<DD>Signature check. Check whether <A HREF="../../../ds/ov2/front/Host_signature.html#hash"><CODE>hash</CODE></A> and <A HREF="../../../ds/ov2/front/Host_signature.html#number"><CODE>number</CODE></A> forms a valid signature for the blinded attribute
 expression <code>blinded_a</code> with respect to the PTLS
 parameters <code>params</code>. 
 <P>

 If the argument <code>montgomerized</code> is true this method
 performs a check for a montgomerized signature, that is a
 signature where numbers must be montgomerized before they are
 fed into the hash function. Further, when <code>montgomerized</code>
 is true it is assumed that <code>blinded_a</code> is already
 montgomerized. In essence, for a signature from the
 Montgomerizing applet <code>montgomerized</code> should be true and
 otherwise false.
 <P>

 Restrictions of the hash size (see <A HREF="../../../ds/ov2/front/Signature.html" title="class in ds.ov2.front"><CODE>Signature</CODE></A> and <A HREF="../../../ds/ov2/front/Hash_size.html" title="class in ds.ov2.front"><CODE>Hash_size</CODE></A>) are taken into account as necessary. 
 
 The source code of this method is affected by Brand's patents
 on selective disclosure protocols that are now in the posession
 of Microsoft. Microsoft lawyers are still pondering our request
 from January 2009 for making the full source code publically
 available. The source code of this method is therefore
 currently not publically available. The detailed operations of
 this method are:
 <DL>
 <DT><STRONG>XXXXXXXXXXXXXXX</STRONG>
 <DD>
 <DT><STRONG></STRONG>
 <DD>
 <DT><STRONG></STRONG>
 <DD>
 <DT><STRONG></STRONG>
 <DD>
 </DL>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blinded_a</CODE> - the blinded attribute expression that was
 signed; in montgomerized form if <code>montgomerized</code> is true<DD><CODE>params</CODE> - the PTLS parameters<DD><CODE>montgomerized</CODE> - true if the signature and <code>blinded_a</code> come from the montgomerizing applet
<DT><B>Returns:</B><DD>true if the signature is valid, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="check_signature_ex(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)"><!-- --></A><H3>
check_signature_ex</H3>
<PRE>
public boolean <B>check_signature_ex</B>(<A HREF="http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html?is-external=true" title="class or interface in java.math">BigInteger</A>&nbsp;blinded_a,
                                  <A HREF="../../../ds/ov2/front/PTLS_rsa_parameters.html" title="class in ds.ov2.front">PTLS_rsa_parameters</A>&nbsp;params,
                                  boolean&nbsp;montgomerized)</PRE>
<DL>
<DD>Debug and exception wrapper for <A HREF="../../../ds/ov2/front/Host_signature.html#check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)"><CODE>check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)</CODE></A>.
 Prints the arguments to <A HREF="../../../ds/ov2/front/Host_signature.html#out"><CODE>out</CODE></A> if that is non-null and
 prints information about escaping runtime exceptions to <A HREF="../../../ds/ov2/front/Host_signature.html#out"><CODE>out</CODE></A> or <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/System.html?is-external=true#err" title="class or interface in java.lang"><CODE>System.err</CODE></A>. Does not catch any exception, only
 prints information and rethrows them.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>blinded_a</CODE> - the blinded attribute expression that was
 signed; in montgomerized form if <code>montgomerized</code> is true<DD><CODE>params</CODE> - the PTLS parameters<DD><CODE>montgomerized</CODE> - true if the signature and <code>blinded_a</code> come from the montgomerizing applet
<DT><B>Returns:</B><DD>true if the signature is valid, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="get_hash_size()"><!-- --></A><H3>
get_hash_size</H3>
<PRE>
int <B>get_hash_size</B>()</PRE>
<DL>
<DD>Return the size of the hash <A HREF="../../../ds/ov2/front/Host_signature.html#hash"><CODE>hash</CODE></A>. Needed for the
 compatibility check in <A HREF="../../../ds/ov2/front/Signature.html#is_compatible_with(java.lang.Object)"><CODE>Signature.is_compatible_with</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the size of the hash in bytes</DL>
</DD>
</DL>
<HR>

<A NAME="get_number_size()"><!-- --></A><H3>
get_number_size</H3>
<PRE>
int <B>get_number_size</B>()</PRE>
<DL>
<DD>Return the size of the number <A HREF="../../../ds/ov2/front/Host_signature.html#number"><CODE>number</CODE></A>. Needed for the
 compatibility check in <A HREF="../../../ds/ov2/front/Signature.html#is_compatible_with(java.lang.Object)"><CODE>Signature.is_compatible_with</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the size of <A HREF="../../../ds/ov2/front/Host_signature.html#number"><CODE>number</CODE></A> in bytes</DL>
</DD>
</DL>
<HR>

<A NAME="get_array()"><!-- --></A><H3>
get_array</H3>
<PRE>
protected <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[] <B>get_array</B>()</PRE>
<DL>
<DD>Return <A HREF="../../../ds/ov2/front/Host_signature.html#serializable_contents"><CODE>serializable_contents</CODE></A> in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#get_array()">get_array</A></CODE> in class <CODE><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>array of objects to (de-)serialize</DL>
</DD>
</DL>
<HR>

<A NAME="get_length()"><!-- --></A><H3>
get_length</H3>
<PRE>
public short <B>get_length</B>()</PRE>
<DL>
<DD>Return 2 as effective size in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#get_length()">get_length</A></CODE> in class <CODE><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>2</DL>
</DD>
</DL>
<HR>

<A NAME="from_byte_array(short, short, byte[], short)"><!-- --></A><H3>
from_byte_array</H3>
<PRE>
public short <B>from_byte_array</B>(short&nbsp;len,
                             short&nbsp;this_index,
                             byte[]&nbsp;byte_array,
                             short&nbsp;byte_index)</PRE>
<DL>
<DD>Deserialization of this object for the OV-chip protocol layer.
 See <A HREF="../../../ds/ov2/util/APDU_Serializable.html#from_byte_array(short, short, byte[], short)"><CODE>APDU_Serializable.from_byte_array</CODE></A>.
 <P>

 Overridden here to initialize <A HREF="../../../ds/ov2/front/Host_signature.html#number"><CODE>number</CODE></A> from the APDU
 wrapper after deserialization finished.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../ds/ov2/util/APDU_Serializable.html#from_byte_array(short, short, byte[], short)">from_byte_array</A></CODE> in interface <CODE><A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></CODE><DT><B>Overrides:</B><DD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#from_byte_array(short, short, byte[], short)">from_byte_array</A></CODE> in class <CODE><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>len</CODE> - available data in <code>byte_array</code><DD><CODE>this_index</CODE> - number of bytes that
 have already been read in preceeding calls<DD><CODE>byte_array</CODE> - data array to deserialize from<DD><CODE>byte_index</CODE> - index in <code>byte_array</code>
<DT><B>Returns:</B><DD>the number of bytes actually read, except for the case 
 where deserialization finished by reading precisely 
 <code>len</code> bytes, in this case <code>len + 1</code> is 
 returned.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Host_signature.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../ds/ov2/front/Hash_size.html" title="class in ds.ov2.front"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../ds/ov2/front/Host_testframe.html" title="class in ds.ov2.front"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?ds/ov2/front/Host_signature.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Host_signature.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
