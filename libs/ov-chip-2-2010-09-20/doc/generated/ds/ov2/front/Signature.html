<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_21) on Mon Sep 20 22:29:37 CEST 2010 -->
<TITLE>
Signature
</TITLE>

<META NAME="date" CONTENT="2010-09-20">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Signature";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Signature.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../ds/ov2/front/RSA_squared_card.html" title="class in ds.ov2.front"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../ds/ov2/front/State.html" title="class in ds.ov2.front"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?ds/ov2/front/Signature.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Signature.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
ds.ov2.front</FONT>
<BR>
Class Signature</H2>
<PRE>
<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">ds.ov2.util.Serializable_array</A>
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>ds.ov2.front.Signature</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>Signature</B><DT>extends <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A><DT>implements <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></DL>
</PRE>

<P>
Signatures on blinded attribute expressions. This class only
 provides the storage for a signature. Any computation with the
 signature has to be done outside. During digest computation one
 should use <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A> as output buffer. When digest
 computation is finished one has to call <A HREF="../../../ds/ov2/front/Signature.html#commit_hash()"><CODE>commit_hash()</CODE></A>, which
 either does nothing or copies the restricted hash into <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A>. <P>

 Signature creation is done in <A HREF="../../../ds/ov2/front/RSA_squared_card.html#make_sig_hash()"><CODE>RSA_squared_card.make_sig_hash()</CODE></A> and <A HREF="../../../ds/ov2/front/RSA_squared_card.html#finish_signature(ds.ov2.util.APDU_boolean)"><CODE>RSA_squared_card.finish_signature</CODE></A> and similar methods in <A HREF="../../../ds/ov2/front/RSA_plain_card.html" title="class in ds.ov2.front"><CODE>RSA_plain_card</CODE></A> and <A HREF="../../../ds/ov2/front/RSA_mont_card.html" title="class in ds.ov2.front"><CODE>RSA_mont_card</CODE></A>. Signature checking is
 done in <A HREF="../../../ds/ov2/front/Host_signature.html#check_signature(java.math.BigInteger, ds.ov2.front.PTLS_rsa_parameters, boolean)"><CODE>Host_signature.check_signature</CODE></A>. <P>

 This is a card data type. It is compatible with
 <UL>
 <LI>Signature and <A HREF="../../../ds/ov2/front/Host_signature.html" title="class in ds.ov2.front"><CODE>Host_signature</CODE></A> if the hash and the number
 have the same sizes, respectively.</LI>
 </UL>
 <P>

 A signature consists of a hash <code>c</code> and a number <code>r</code>
 such that <code>c = H(A, r^v * (h * A) ^ -c)</code>, where <code>H</code> is
 a hash function, <code>A</code> is the blinded attribute expression,
 <code>v</code> is the public RSA exponent (see <A HREF="../../../ds/ov2/front/RSA_data.html#v"><CODE>RSA_data.v</CODE></A> and
 <A HREF="../../../ds/ov2/front/PTLS_rsa_parameters.html#v"><CODE>PTLS_rsa_parameters.v</CODE></A>), and <code>h</code> is the public PTLS
 key (see <A HREF="../../../ds/ov2/front/RSA_data.html#ptls_key"><CODE>RSA_data.ptls_key</CODE></A> and <A HREF="../../../ds/ov2/front/PTLS_rsa_parameters.html#ptls_public_key"><CODE>PTLS_rsa_parameters.ptls_public_key</CODE></A>). As you can see, the hash
 value <code>c</code> is considered as a number and takes part in the
 computation. 
 <P>

 For simplicity the Montgomerizing applet does not demontgomerize
 the numbers in the resign protocol before feeding numbers to the
 hash function. This results in what I would call a montgomerized
 signature, that is a signature where one has to montgomerize the
 numbers before feeding them to the hash function in the signature
 check. 
 <P>

 During resigning the applet needs to compute <code>r * beta2 *
 beta1 ^ c * (h A)^ q</code>. What is important here, is that the hash
 <code>c</code> is used as an exponent on the card. In the plain and the
 squared applets the power <code>beta1 ^ c</code> is computed with an
 <A HREF="../../../ds/ov2/bignat/RSA_exponent.html" title="class in ds.ov2.bignat"><CODE>RSA_exponent</CODE></A>, that accepts a number of
 (almost) arbitrary size as exponent. In these two applets I use
 <A HREF="../../../ds/ov2/front/RSA_plain_card.html#double_small"><CODE>RSA_plain_card.double_small</CODE></A> and, respectively, <A HREF="../../../ds/ov2/front/RSA_squared_card.html#double_small"><CODE>RSA_squared_card.double_small</CODE></A> to hold the hash and pass it on to
 the <A HREF="../../../ds/ov2/bignat/RSA_exponent.html" title="class in ds.ov2.bignat"><CODE>RSA_exponent</CODE></A>. Further, for the
 computation of <code>q</code> it is necessary to sum <code>c + beta3</code>,
 where <code>beta3</code> is a random less than <code>v</code>. This sum is
 also computed in <code>double_small</code>. <P>

 Therefore in the plain and squareing applets the hash must fit into
 a number of twice the exponent size and there must further be
 enough room to add a number of exponent size. For the Java cards
 that we currently have the base size is restricted to 512 - 1952
 bits, which, according to Lenstra (see <A HREF="../../../ds/ov2/util/Security_parameter.html" title="class in ds.ov2.util"><CODE>Security_parameter</CODE></A>), corresponds to an exponent size
 of 94 - 198 bits or 12 - 25 bytes. For the hash function <code>H</code>
 I use 160 bit SHA-1 (<A HREF="http://www.cs.ru.nl/~woj/javacardapi221/javacard/security/MessageDigest.html?is-external=true#ALG_SHA" title="class or interface in javacard.security"><CODE>MessageDigest.ALG_SHA</CODE></A>), which produces 20 byte
 hashes. Thus, if the exponent size is chosen according to Lenstra,
 the variable <code>double_small</code> is big enough.
 <P>

 For testing in the host test frames I however permit RSA key sizes
 below 512 bits. Then the <code>double_small</code> might not be big
 enough. In such cases (where security is broken anyways) I restrict
 the size of the hash to <code>2 * short_bignat_size -1</code> for the
 plain and the squaring applet, where <code>short_bignat_size</code> is
 the size of <code>v</code>. The restriction is done by using only the
 last bytes of the output of <code>H</code>. The computation of the hash
 size is done in <A HREF="../../../ds/ov2/front/Hash_size.html#hash_size(short, byte)"><CODE>Hash_size.hash_size</CODE></A>.
 The hash of the required size is always stored in <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A>.
 For the output of <code>H</code> there is an additional byte array
 <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A>. In the normal case, where the full output
 of <code>H</code> is used <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A> is merely an alias of
 <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A>. If the hash size is restricted it is a separate
 array. 
 <P>

 In the Montgomerizing applet I use two additional <A HREF="../../../ds/ov2/bignat/Vector.html" title="class in ds.ov2.bignat"><CODE>Vector's</CODE></A> <A HREF="../../../ds/ov2/front/RSA_mont_card.html#temp_base_vec"><CODE>RSA_mont_card.temp_base_vec</CODE></A>
 and <A HREF="../../../ds/ov2/front/RSA_mont_card.html#temp_exp_vec"><CODE>RSA_mont_card.temp_exp_vec</CODE></A> of size two to compute
 <code>beta1 ^ c * (h A)^ q</code> using simultaneous repeated squaring.
 Until now I have not found any hints on how big <code>c</code> and
 therefore <code>q</code> should be in relation with <code>v</code>. Therefore
 I decided to use the normal exponent size for the exponent vector
 for the computation of <code>beta1 ^ c * (h A)^ q</code> (which has the
 nice side effect that the two additional vectors are perfectly
 suited for computing <code>beta2 ^ v * (h * A) ^ beta3</code> for the
 second hash input). Therefore, for the Montgomerizing applet the
 hash is restricted to the size of the exponent (the sum <code>c +
 beta3</code> is still computed in <code>double_small</code>, so the hash can
 really be as long as the exponents). This means that for the
 Montgomerizing applet the full hash is only used for RSA key sizes
 greater than 1184 bits. For Java Card resigning takes already more
 than one hour for 512 bits in the Montgomerizing applet, so any
 secure RSA key sizes are out of reach any way. For smart phones
 this point might need to be reconsidered.
<P>

<P>
<DL>
<DT><B>CPP Preprocessing</B></DT>
  <DD>This class uses the following cpp defines:
   <a href="../../../overview-summary.html#PACKAGE">PACKAGE</a>,
   <a href="../../../overview-summary.html#PUBLIC">PUBLIC</a>,
   <a href="../../../overview-summary.html#ASSERT">ASSERT</a>,
   <a href="../../../overview-summary.html#JAVACARD_APPLET">JAVACARD_APPLET<a></DD>
<DT><B>Execution Environment:</B></DT>
  <DD>card</DD>
<DT><B>Author:</B></DT>
  <DD>Hendrik Tews</DD>
<DT><B>Version:</B></DT>
  <DD>$Revision: 1.11 $</DD>
<DT><B>Last Commit:</B></DT>
  <DD>$Date: 2009-06-17 21:16:39 $ by $Author: tews $</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;byte</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#applet_id">applet_id</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value of the third constructor argument <code>applet_id</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;<A HREF="../../../ds/ov2/util/APDU_byte_array.html" title="class in ds.ov2.util">APDU_byte_array</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#hash">hash</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The hash <code>c</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;byte[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf">hash_output_buf</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output buffer for the digest algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;<A HREF="../../../ds/ov2/bignat/Bignat.html" title="class in ds.ov2.bignat">Bignat</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#number">number</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number <code>r</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#serializable_contents">serializable_contents</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array of <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A> and <A HREF="../../../ds/ov2/front/Signature.html#number"><CODE>number</CODE></A> for <A HREF="../../../ds/ov2/front/Signature.html#get_array()"><CODE>get_array()</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#sig_long_size">sig_long_size</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value of the second constructor argument <code>short_bignat_size</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#sig_short_size">sig_short_size</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value of the first constructor argument <code>short_bignat_size</code>.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#Signature(short, short, byte)">Signature</A></B>(short&nbsp;short_bignat_size,
          short&nbsp;long_bignat_size,
          byte&nbsp;applet_id)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a new Signature object.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#commit_hash()">commit_hash</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Produce a properly sized hash value out of the data in <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#get_array()">get_array</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return <A HREF="../../../ds/ov2/front/Signature.html#serializable_contents"><CODE>serializable_contents</CODE></A> in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#get_length()">get_length</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return 2 as effective size in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#hash_into_bignat(ds.ov2.bignat.Bignat)">hash_into_bignat</A></B>(<A HREF="../../../ds/ov2/bignat/Bignat.html" title="class in ds.ov2.bignat">Bignat</A>&nbsp;b)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copies the hash value <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A> into a Bignat.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/front/Signature.html#is_compatible_with(java.lang.Object)">is_compatible_with</A></B>(<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;o)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compatibility check for the OV-chip protocol layer.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_ds.ov2.util.Serializable_array"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class ds.ov2.util.<A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#from_byte_array(short, short, byte[], short)">from_byte_array</A>, <A HREF="../../../ds/ov2/util/Serializable_array.html#size()">size</A>, <A HREF="../../../ds/ov2/util/Serializable_array.html#to_byte_array(short, short, byte[], short)">to_byte_array</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_ds.ov2.util.APDU_Serializable"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from interface ds.ov2.util.<A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../ds/ov2/util/APDU_Serializable.html#from_byte_array(short, short, byte[], short)">from_byte_array</A>, <A HREF="../../../ds/ov2/util/APDU_Serializable.html#size()">size</A>, <A HREF="../../../ds/ov2/util/APDU_Serializable.html#to_byte_array(short, short, byte[], short)">to_byte_array</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="hash"><!-- --></A><H3>
hash</H3>
<PRE>
<A HREF="../../../ds/ov2/util/APDU_byte_array.html" title="class in ds.ov2.util">APDU_byte_array</A> <B>hash</B></PRE>
<DL>
<DD>The hash <code>c</code>. Size is determined by <A HREF="../../../ds/ov2/front/Hash_size.html#hash_size(short, byte)"><CODE>Hash_size.hash_size</CODE></A>.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="number"><!-- --></A><H3>
number</H3>
<PRE>
<A HREF="../../../ds/ov2/bignat/Bignat.html" title="class in ds.ov2.bignat">Bignat</A> <B>number</B></PRE>
<DL>
<DD>The number <code>r</code>. Long bignat.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="serializable_contents"><!-- --></A><H3>
serializable_contents</H3>
<PRE>
private <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[] <B>serializable_contents</B></PRE>
<DL>
<DD>Array of <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A> and <A HREF="../../../ds/ov2/front/Signature.html#number"><CODE>number</CODE></A> for <A HREF="../../../ds/ov2/front/Signature.html#get_array()"><CODE>get_array()</CODE></A>.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="hash_output_buf"><!-- --></A><H3>
hash_output_buf</H3>
<PRE>
byte[] <B>hash_output_buf</B></PRE>
<DL>
<DD>Output buffer for the digest algorithm. Either an alias of
 <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A> or a separate byte array. After filling it,
 <A HREF="../../../ds/ov2/front/Signature.html#commit_hash()"><CODE>commit_hash()</CODE></A> must be called.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="sig_short_size"><!-- --></A><H3>
sig_short_size</H3>
<PRE>
final short <B>sig_short_size</B></PRE>
<DL>
<DD>Value of the first constructor argument <code>short_bignat_size</code>. Available here for the stub code of the
 OV-chip protocol layer, to enable it to construct properly
 sized objects on the fly.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="sig_long_size"><!-- --></A><H3>
sig_long_size</H3>
<PRE>
final short <B>sig_long_size</B></PRE>
<DL>
<DD>Value of the second constructor argument <code>short_bignat_size</code>. Available here for the stub code of the
 OV-chip protocol layer, to enable it to construct properly
 sized objects on the fly.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="applet_id"><!-- --></A><H3>
applet_id</H3>
<PRE>
final byte <B>applet_id</B></PRE>
<DL>
<DD>Value of the third constructor argument <code>applet_id</code>. Available here for the stub code of the
 OV-chip protocol layer, to enable it to construct properly
 sized objects on the fly.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Signature(short, short, byte)"><!-- --></A><H3>
Signature</H3>
<PRE>
public <B>Signature</B>(short&nbsp;short_bignat_size,
                 short&nbsp;long_bignat_size,
                 byte&nbsp;applet_id)</PRE>
<DL>
<DD>Create a new Signature object. Sizes of internal numbers and
 buffers depend on the base and exponent size as well as on the
 applet (see discussion above and <A HREF="../../../ds/ov2/front/Hash_size.html" title="class in ds.ov2.front"><CODE>Hash_size</CODE></A>).
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>short_bignat_size</CODE> - size of the exponent bignats in bytes<DD><CODE>long_bignat_size</CODE> - size of the base bignats in bytes<DD><CODE>applet_id</CODE> - the applet ID</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="commit_hash()"><!-- --></A><H3>
commit_hash</H3>
<PRE>
void <B>commit_hash</B>()</PRE>
<DL>
<DD>Produce a properly sized hash value out of the data in <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A>. Does nothing if <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A> has size
 <A HREF="../../../ds/ov2/front/Hash_size.html#digest_output_size"><CODE>Hash_size.digest_output_size</CODE></A> and <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A> is an alias of <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A>. Otherwise
 copies the last bytes of <A HREF="../../../ds/ov2/front/Signature.html#hash_output_buf"><CODE>hash_output_buf</CODE></A> into <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="hash_into_bignat(ds.ov2.bignat.Bignat)"><!-- --></A><H3>
hash_into_bignat</H3>
<PRE>
void <B>hash_into_bignat</B>(<A HREF="../../../ds/ov2/bignat/Bignat.html" title="class in ds.ov2.bignat">Bignat</A>&nbsp;b)</PRE>
<DL>
<DD>Copies the hash value <A HREF="../../../ds/ov2/front/Signature.html#hash"><CODE>hash</CODE></A> into a Bignat. 
 <P>

 Asserts that the size of <code>b</code> is sufficient.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b</CODE> - Bignat to copy the hash into</DL>
</DD>
</DL>
<HR>

<A NAME="get_array()"><!-- --></A><H3>
get_array</H3>
<PRE>
protected <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[] <B>get_array</B>()</PRE>
<DL>
<DD>Return <A HREF="../../../ds/ov2/front/Signature.html#serializable_contents"><CODE>serializable_contents</CODE></A> in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#get_array()">get_array</A></CODE> in class <CODE><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>array of objects to (de-)serialize</DL>
</DD>
</DL>
<HR>

<A NAME="get_length()"><!-- --></A><H3>
get_length</H3>
<PRE>
public short <B>get_length</B>()</PRE>
<DL>
<DD>Return 2 as effective size in support for abstract
 <A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util"><CODE>Serializable_array</CODE></A>.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#get_length()">get_length</A></CODE> in class <CODE><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>2</DL>
</DD>
</DL>
<HR>

<A NAME="is_compatible_with(java.lang.Object)"><!-- --></A><H3>
is_compatible_with</H3>
<PRE>
public boolean <B>is_compatible_with</B>(<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A>&nbsp;o)</PRE>
<DL>
<DD>Compatibility check for the OV-chip protocol layer. Signature
 is compatible with 
 <UL>
 <LI>Signature and <A HREF="../../../ds/ov2/front/Host_signature.html" title="class in ds.ov2.front"><CODE>Host_signature</CODE></A> if the hash and the number
 have the same sizes, respectively.</LI>
 </UL>
 See <a href="../util/APDU_Serializable.html#apdu_compatibility">
 the compatibility check 
 explanations</a> and also
 <A HREF="../../../ds/ov2/util/APDU_Serializable.html#is_compatible_with(java.lang.Object)"><CODE>APDU_Serializable.is_compatible_with</CODE></A>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../ds/ov2/util/APDU_Serializable.html#is_compatible_with(java.lang.Object)">is_compatible_with</A></CODE> in interface <CODE><A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A></CODE><DT><B>Overrides:</B><DD><CODE><A HREF="../../../ds/ov2/util/Serializable_array.html#is_compatible_with(java.lang.Object)">is_compatible_with</A></CODE> in class <CODE><A HREF="../../../ds/ov2/util/Serializable_array.html" title="class in ds.ov2.util">Serializable_array</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>o</CODE> - actual argument or result
<DT><B>Returns:</B><DD>true if this (the declared argument or result) is considered 
         binary compatible with <code>o</code>.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Signature.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../ds/ov2/front/RSA_squared_card.html" title="class in ds.ov2.front"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../ds/ov2/front/State.html" title="class in ds.ov2.front"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?ds/ov2/front/Signature.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Signature.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
