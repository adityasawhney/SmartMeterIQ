<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_21) on Mon Sep 20 22:29:36 CEST 2010 -->
<TITLE>
Installation_arguments
</TITLE>

<META NAME="date" CONTENT="2010-09-20">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Installation_arguments";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Installation_arguments.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../ds/ov2/util/Host_protocol.html" title="class in ds.ov2.util"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../ds/ov2/util/Int_option.html" title="class in ds.ov2.util"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?ds/ov2/util/Installation_arguments.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Installation_arguments.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
ds.ov2.util</FONT>
<BR>
Class Installation_arguments</H2>
<PRE>
<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>ds.ov2.util.Installation_arguments</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>Installation_arguments</B><DT>extends <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
Decode Java Card applet installation arguments into an <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util"><CODE>APDU_Serializable</CODE></A> array. Relies on parts of the OV-chip protocol
 layer. Therefore the installation arguments must be encoded as for
 the OV-chip protocol: A sequence of plain data bytes without
 intermediate length information. Two short arguments must for
 instance be encoded with 4 bytes.
 <P>

 The byte array which the applet install method receives contains
 the applet ID, some control info and the actual installation
 arguments (called applet data in the SUN docs) in a length-value
 encoding (see <A HREF="http://www.cs.ru.nl/~woj/javacardapi221/javacard/framework/Applet.html?is-external=true#install(byte[], short, byte)" title="class or interface in javacard.framework"><CODE>Applet.install</CODE></A> for the details). This class can parse the complete
 data to find the actual installation arguments. Decoded are however
 only the installation arguments and not the other stuff. <P>

 When specifying the installation arguments in some applet
 installation programm one typically has to prepend a size byte to
 the encoded installation arguments. Sometimes (for instance for the
 global platform manager) an additional leading 0xC9 must be
 inserted. (This 0xC9 is a tag that tells the global platform that
 the bytes that follow are applet installation arguments, if I
 remember correctly.) In the example of the two shorts one would
 have to specify 0xC9 0x04 plus 4 data bytes.
 <P>

 To encode the installation arguments in the host driver one can use
 <A HREF="../../../ds/ov2/util/Convert_serializable.html#array_to_bytes(ds.ov2.util.APDU_Serializable[], byte[], int)"><CODE>Convert_serializable.array_to_bytes</CODE></A> as in the following code
 fragment 
 <pre>
    APDU_Serializable[] arguments = ...
    int arg_length = Misc.length_of_serializable_array(arguments);
    assert arg_length < 127;
    byte[] serialized_args = new byte[arg_length + 2];
    serialized_args[0] = (byte)0xC9;
    serialized_args[1] = (byte)arg_length;
    int res = Convert_serializable.array_to_bytes(arguments, serialized_args, 2); 
    assert res == serialized_args.length;
 </pre>
 The <code>arguments</code> array in the host driver most be compatible
 (in the sense of <A HREF="../../../ds/ov2/util/Convert_serializable.html#check_compatibility(ds.ov2.util.APDU_Serializable[], ds.ov2.util.APDU_Serializable[])"><CODE>Convert_serializable.check_compatibility</CODE></A>) to the ones that are
 used in the applet and passed into <A HREF="../../../ds/ov2/util/Installation_arguments.html#decode(byte[], short, byte, ds.ov2.util.APDU_Serializable[])"><CODE>decode</CODE></A>.
 <P>

 The specification of the data format of the installation arguments
 comes from SUN as well as the emulators cref and jcwde. But it
 would be expecting far too much that SUN tools follow SUN
 specifications. An applet running in cref or jcwde only sees the
 actual installation arguments in the byte array that the install
 method gets. No applet ID, no control info, not even a length byte.
 When <a
 href="../../../overview-summary.html#CREF_INSTALL_ARG_HACK">CREF_INSTALL_ARG_HACK<a>
 is defined the code here works around this bug. If it is undefined
 one will get strange errors inside cref and jcwde. <P>

 This is a static class.
<P>

<P>
<DL>
<DT><B>CPP Preprocessing</B></DT>
  <DD>This class uses the following cpp defines:
   <a href="../../../overview-summary.html#PACKAGE">PACKAGE</a>,
   <a href="../../../overview-summary.html#PUBLIC">PUBLIC</a>,
   <a href="../../../overview-summary.html#ASSERT">ASSERT</a>,
   <a href="../../../overview-summary.html#CREF_INSTALL_ARG_HACK">CREF_INSTALL_ARG_HACK<a></DD>
<DT><B>Execution Environment:</B></DT>
  <DD>card</DD>
<DT><B>Author:</B></DT>
  <DD>Hendrik Tews</DD>
<DT><B>Version:</B></DT>
  <DD>$Revision: 1.9 $</DD>
<DT><B>Last Commit:</B></DT>
  <DD>$Date: 2009-04-09 10:42:16 $ by $Author: tews $</DD>
</DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/util/Installation_arguments.html#Installation_arguments()">Installation_arguments</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Static class, object creation disabled.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../ds/ov2/util/Installation_arguments.html#decode(byte[], short, byte, ds.ov2.util.APDU_Serializable[])">decode</A></B>(byte[]&nbsp;bytes,
       short&nbsp;start,
       byte&nbsp;len,
       <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[]&nbsp;arguments)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decode the actual applet installation arguments.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Installation_arguments()"><!-- --></A><H3>
Installation_arguments</H3>
<PRE>
protected <B>Installation_arguments</B>()</PRE>
<DL>
<DD>Static class, object creation disabled.
<P>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="decode(byte[], short, byte, ds.ov2.util.APDU_Serializable[])"><!-- --></A><H3>
decode</H3>
<PRE>
public static void <B>decode</B>(byte[]&nbsp;bytes,
                          short&nbsp;start,
                          byte&nbsp;len,
                          <A HREF="../../../ds/ov2/util/APDU_Serializable.html" title="interface in ds.ov2.util">APDU_Serializable</A>[]&nbsp;arguments)</PRE>
<DL>
<DD>Decode the actual applet installation arguments. The first
 three arguments are the unmodified arguments from the <A HREF="http://www.cs.ru.nl/~woj/javacardapi221/javacard/framework/Applet.html?is-external=true#install(byte[], short, byte)" title="class or interface in javacard.framework"><CODE>install</CODE></A> method. The last
 argument are the declared installation arguments. This method
 checks (with <a
 href="../../../overview-summary.html#ASSERT">ASSERT<a>) that
 the size of the installation arguments fits with the incoming
 data. <P>

 When <a
 href="../../../overview-summary.html#CREF_INSTALL_ARG_HACK">CREF_INSTALL_ARG_HACK<a>
 is defined this method tries to work around the bugs in the
 cref and jcwde emulators.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>bytes</CODE> - the array containing the raw data<DD><CODE>start</CODE> - the starting offset in <code>bytes</code><DD><CODE>len</CODE> - the length of the raw data<DD><CODE>arguments</CODE> - the declared arguments into which the raw data
 is decoded</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Installation_arguments.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../ds/ov2/util/Host_protocol.html" title="class in ds.ov2.util"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../ds/ov2/util/Int_option.html" title="class in ds.ov2.util"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?ds/ov2/util/Installation_arguments.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Installation_arguments.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
