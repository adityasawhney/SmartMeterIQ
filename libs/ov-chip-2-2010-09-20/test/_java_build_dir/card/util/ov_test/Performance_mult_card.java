//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//!!!   DO NOT EDIT OR CHANGE THIS FILE. CHANGE THE ORIGINAL INSTEAD.      !!!
//!!!   THIS FILE HAS BEEN GENERATED BY CPP AND SED,                       !!!
//!!!   BECAUSE JAVA DOES NOT SUPPORT CONDITIONAL COMPILATION.             !!!
//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//# 1 "/tmp/tews/ov-dist/ov-chip-2-2010-09-20/test/Performance_mult_card.java"
//# 1 "<built-in>"
//# 1 "<command-line>"
//# 1 "/tmp/tews/ov-dist/ov-chip-2-2010-09-20/test/Performance_mult_card.java"
// 
// OV-chip 2.0 project
// 
// Digital Security (DS) group at Radboud Universiteit Nijmegen
// 
// Copyright (C) 2008, 2009
// 
// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU General Public License as
// published by the Free Software Foundation; either version 2 of
// the License, or (at your option) any later version.
// 
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
// General Public License in file COPYING in this or one of the
// parent directories for more details.
// 
// Created 1.9.08 by Hendrik
// 
// measure the multiplication performance
// 
// $Id: Performance_mult_card.java,v 1.10 2009-06-02 13:27:57 tews Exp $

//# 1 "./config" 1
// 
// OV-chip 2.0 project
// 
// Digital Security (DS) group at Radboud Universiteit Nijmegen
// 
// Copyright (C) 2008, 2009
// 
// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU General Public License as
// published by the Free Software Foundation; either version 2 of
// the License, or (at your option) any later version.
// 
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
// General Public License in file COPYING in this or one of the
// parent directories for more details.
// 
// Created 26.7.08 by Hendrik
// 
// preprocessor config directives
// 
// $Id: config,v 1.17 2010-02-16 10:26:10 tews Exp $
//# 53 "./config"
  // For the jcwde emulator the applet class must be public
//# 91 "./config"
/// Local Variables:
/// mode: c
/// End:
//# 26 "/tmp/tews/ov-dist/ov-chip-2-2010-09-20/test/Performance_mult_card.java" 2


  package ov_test;




import javacard.framework.APDU;







/** 
 * Card/applet methods for testing Montgomery multiplication,
 * demontgomerization and division. 
 *
 * @author Hendrik Tews
 * @version $Revision: 1.10 $
 * @commitdate $Date: 2009-06-02 13:27:57 $ by $Author: tews $
 * @environment card
 */
 class Performance_mult_card {

    /**
     * 
     * Empty constructor.
     */
    public Performance_mult_card() {}


    /**
     * 
     * Test Montgomery multiplication. Perform {@code rounds} calls to
     * {@link Bignat#montgomery_mult Bignat.montgomery_mult}.
     * 
     * @param fac_1 first factor
     * @param fac_2 second factor
     * @param m modulus
     * @param result result reference
     * @param rounds number of multiplication rounds
     */
    public void mont_mult(Bignat fac_1, Bignat fac_2, Modulus m,
                     Bignat result, short rounds)
    {
        for(short i = 0; i < rounds; i++) {
            result.montgomery_mult(fac_1, fac_2, m);
        }
        return;
    }


    /**
     * 
     * Test Demontgomerization. Perform {@code rounds} calls to {@link
     * Bignat#demontgomerize Bignat.demontgomerize}.
     * 
     * @param n number to demontgomerize
     * @param m modulus
     * @param result result reference
     * @param rounds number of demontgomerization rounds
     */
    public void demontgomerize(Bignat n, Modulus m,
                               Bignat result, short rounds)
    {
        result.copy(n);
        if(rounds > 0) {
            result.demontgomerize(m);
            while(rounds-- > 1) {
                result.copy(n);
                result.demontgomerize(m);
            }
        }
    }


    /**
     * 
     * Test division and remainder. Perform {@code rounds} calls to
     * {@link Bignat#remainder_divide Bignat.remainder_divide}.
     * 
     * @param divident divident argument
     * @param divisor divisor argument
     * @param remainder reference for the remainder result
     * @param result reference for the quotient result (may be null)
     * @param rounds number of division rounds
     */
    public void remainder_divide(Bignat divident, Bignat divisor,
                                 Bignat remainder, Bignat result,
                                 short rounds)
    {
        for(short i = 0; i < rounds; i++) {
            remainder.copy(divident);
            remainder.remainder_divide(divisor, result);
        }
        return;
    }
}
